---
phase: 02-schedule-visualization
plan: 03
type: execute
wave: 1
depends_on: ["02-02"]
files_modified: ["frontend/src/App.tsx"]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Time blocks appear as colored strips on schedule"
    - "Time blocks visible in both compact and expanded schedule views"
  artifacts:
    - path: "frontend/src/App.tsx"
      provides: "timeBlocks extraction and prop passing"
      contains: "timeBlocks"
  key_links:
    - from: "frontend/src/App.tsx"
      to: "DaySchedule"
      via: "timeBlocks prop"
      pattern: "timeBlocks=\\{timeBlocks\\}"
    - from: "frontend/src/App.tsx"
      to: "ScheduleExpandedModal"
      via: "timeBlocks prop"
      pattern: "timeBlocks=\\{timeBlocks\\}"
---

<objective>
Wire timeBlocks from dailyNote to schedule components in App.tsx

Purpose: Close the final gap in Phase 2 — TimeBlock components are built and integrated in DaySchedule/ScheduleExpandedModal, but App.tsx doesn't pass the data to them. This single fix completes the entire phase.

Output: TimeBlocks visible on both schedule views
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-schedule-visualization/02-VERIFICATION.md

# Component props already support timeBlocks:
# DaySchedule: timeBlocks?: TimeBlock[] (line 17 of DaySchedule.tsx)
# ScheduleExpandedModal: timeBlocks?: TimeBlock[] (line 42 of ScheduleExpandedModal.tsx)

@frontend/src/App.tsx
@frontend/src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire timeBlocks in App.tsx</name>
  <files>frontend/src/App.tsx</files>
  <action>
Three changes needed in App.tsx:

1. **Update useMemo return type** (around line 93):
   Add `timeBlocks: TimeBlock[];` to the return type interface.

2. **Extract timeBlocks in useMemo body**:
   - In the `if (!analysisPreview)` branch (line 99-111): extract `timeBlocks: data.timeBlocks || []`
   - In the `if (!dailyNote)` branch (line 114-121): return `timeBlocks: []` (analysis preview doesn't have timeBlocks)
   - In the merge branch (line 124-176): extract `timeBlocks: dailyNote.timeBlocks || []`

3. **Add timeBlocks to destructuring** (around line 93):
   Change `const { displayData, scheduleEvents, scheduledTasks, unscheduledTasks } = useMemo(...)`
   to include `timeBlocks` in destructuring.

4. **Pass timeBlocks prop to DaySchedule** (around line 311):
   Add `timeBlocks={timeBlocks}` prop.

5. **Pass timeBlocks prop to ScheduleExpandedModal** (around line 326):
   Add `timeBlocks={timeBlocks}` prop.

Import TimeBlock type is NOT needed — it's already available from DailyNoteData which is used.
  </action>
  <verify>
  - `npm run build` in frontend/ completes without errors
  - `npm run lint` passes
  - Grep confirms: `grep -n "timeBlocks={timeBlocks}" frontend/src/App.tsx` shows two matches
  </verify>
  <done>
  - useMemo extracts timeBlocks from dailyNote
  - DaySchedule receives timeBlocks prop
  - ScheduleExpandedModal receives timeBlocks prop
  - TimeBlocks now visible on schedule (colored strips with diagonal pattern)
  </done>
</task>

</tasks>

<verification>
After completing the task:

1. **Build verification:**
   ```bash
   cd frontend && npm run build
   ```
   Must complete without TypeScript errors.

2. **Code verification:**
   ```bash
   grep -n "timeBlocks" frontend/src/App.tsx
   ```
   Should show:
   - timeBlocks in useMemo return type
   - timeBlocks extraction in all three branches
   - timeBlocks in destructuring
   - timeBlocks={timeBlocks} passed to DaySchedule
   - timeBlocks={timeBlocks} passed to ScheduleExpandedModal

3. **Visual verification (optional):**
   If time blocks exist in the database for the current day, they should now appear as colored diagonal-striped strips on the left side of the schedule.
</verification>

<success_criteria>
- [ ] App.tsx useMemo returns timeBlocks
- [ ] DaySchedule component receives timeBlocks prop
- [ ] ScheduleExpandedModal component receives timeBlocks prop
- [ ] Build passes without errors
- [ ] Phase 2 VERIFICATION.md gaps are now resolved
</success_criteria>

<output>
After completion, create `.planning/phases/02-schedule-visualization/02-03-SUMMARY.md`
</output>
